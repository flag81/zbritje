const allProducts = 

[{"categoryId": "7", "discountPercentage": null, "discountPrice": "3", "oldPrice": "5", "productId": 6, 
"productName": "Alpsko this is long title that might", "productPic": "alpsko.png", "productSize": null, 
"saleEndDate": "2024-08-30T21:00:00.000Z", "saleId": 1, "saleStartDate": "2024-07-09T22:00:00.000Z", "storeId": "1", 
"storeLogo": "spar.png", "subCategoryId": "70"}, 

{"categoryId": "2", "discountPercentage": null, "discountPrice": "1", "oldPrice": "2", "productId": 13, "productName": "Birra Heinekken", 
"productPic": "heineken.png", "productSize": null, "saleEndDate": "2024-08-30T21:00:00.000Z", "saleId": 1, 
"saleStartDate": "2024-07-09T22:00:00.000Z", "storeId": "2", "storeLogo": "spar.png", "subCategoryId": "20"}, 

{"categoryId": "3", "discountPercentage": null, "discountPrice": null, "oldPrice": null, "productId": 5, "productName": "Ananas", 
"productPic": "ananas.png", "productSize": null, "saleEndDate": null, "saleId": null, "saleStartDate": null, "storeId": null, 
"storeLogo": "spar.png", "subCategoryId": "30"}, 

{"categoryId": "2", "discountPercentage": null, "discountPrice": "1", "oldPrice": "2", 
"productId": 12, "productName": "Birra Peja", "productPic": "birrapeja.jpg", "productSize": null, "saleEndDate": "2024-08-30T21:00:00.000Z", 
"saleId": 1, "saleStartDate": "2024-07-09T22:00:00.000Z", "storeId": "2", "storeLogo": "maxi.png", "subCategoryId": "20"}, 

{"categoryId": "2", "discountPercentage": null, "discountPrice": 
"1", "oldPrice": "2", "productId": 14, "productName": "Birra Tuborg", "productPic": "tuborg.jpg", "productSize": null, 
"saleEndDate": "2024-08-30T21:00:00.000Z", "saleId": 1, "saleStartDate": "2024-07-09T22:00:00.000Z", "storeId": "2", 
"storeLogo": "meridian.png", "subCategoryId": "20"}, 

{"categoryId": "2", "discountPercentage": null, "discountPrice": "12", 
"oldPrice": "15", "productId": 1, "productName": "Coca-Cola", "productPic": "coca-cola.png", "productSize": null, 
"saleEndDate": "2024-08-29T22:00:00.000Z", "saleId": 1, "saleStartDate": "2024-07-09T22:00:00.000Z", "storeId": "1", 
"storeLogo": "viva-fresh.png", "subCategoryId": "20"}, 

{"categoryId": "2", "discountPercentage": null, "discountPrice": "15", 
"oldPrice": "20", "productId": 2, "productName": "Fanta", "productPic": "fanta.png", "productSize": null, 
"saleEndDate": "2024-08-29T22:00:00.000Z", "saleId": 1, "saleStartDate": "2024-07-09T22:00:00.000Z", "storeId": "2", 
"storeLogo": "viva-fresh.png", "subCategoryId": "20"}, 

{"categoryId": "1", "discountPercentage": null, "discountPrice": "10", 
"oldPrice": "12", "productId": 4, "productName": "Nutella", "productPic": "nutella.png", "productSize": null, 
"saleEndDate": "2024-08-29T22:00:00.000Z", "saleId": 1, "saleStartDate": "2024-07-09T22:00:00.000Z", "storeId": "3", 
"storeLogo": "maxi.png", "subCategoryId": "10"}, 

{"categoryId": "3", "discountPercentage": null, "discountPrice": "14", 
"oldPrice": "17", "productId": 11, "productName": "Portokall", "productPic": "portokall.jpg", "productSize": null, 
"saleEndDate": "2024-08-29T22:00:00.000Z", "saleId": 1, "saleStartDate": "2024-07-09T22:00:00.000Z", "storeId": "1", 
"storeLogo": "viva-fresh.png", "subCategoryId": "30"}, 

{"categoryId": "2", "discountPercentage": null, "discountPrice": null, 
"oldPrice": null, "productId": 3, "productName": "Sprite", "productPic": "sprite.png", "productSize": null, "saleEndDate": null, 
"saleId": null, "saleStartDate": null, "storeId": null, "storeLogo": "maxi.png", "subCategoryId": "20"}, 

{"categoryId": "4", "discountPercentage": null, "discountPrice": 
null, "oldPrice": null, "productId": 7, "productName": "Ariel", "productPic": "ariel.jpg", "productSize": null, "saleEndDate": null, 
"saleId": null, "saleStartDate": null, "storeId": null, "storeLogo": "meridian.png", "subCategoryId": "40"}, 


{"categoryId": "3", "discountPercentage": null, "discountPrice": null, "oldPrice": null, "productId": 8, "productName": "Lule laker", 
"productPic": "lule-laker.jpg", "productSize": null, "saleEndDate": null, "saleId": null, "saleStartDate": null, "storeId": null, 
"storeLogo": "meridian.png", "subCategoryId": 
"31"}, 


{"categoryId": "6", "discountPercentage": null, "discountPrice": null, "oldPrice": null, "productId": 9, "productName": "Pampers", 
"productPic": "pampers.jpg", "productSize": null, "saleEndDate": null, "saleId": null, "saleStartDate": null, "storeId": null, 
"storeLogo": "etc.png", "subCategoryId": "60"}, 

{"categoryId": "1", "discountPercentage": null, "discountPrice": null, "oldPrice": null, 
"productId": 10, "productName": "Pasta", "productPic": "pasta.png", "productSize": null, "saleEndDate": null, "saleId": null, 
"saleStartDate": null, "storeId": null, "storeLogo": "etc.png", "subCategoryId": "11"}, 

{"categoryId": "1", "discountPercentage": null, 
"discountPrice": null, "oldPrice": null, "productId": 15, "productName": "Cokollad e zeze Alprose 100g 74per", "productPic": "tuborg.jpg", 
"productSize": null, "saleEndDate": null, "saleId": null, "saleStartDate": null, "storeId": null, "storeLogo": "etc.png", 
"subCategoryId": "12"}];


const favorites = 

[{"categoryId": "3", "favoritescol": null, "id": 311, "keywords": null, "productId": 5, "productName": "Ananas", 
"productPic": "ananas.png", "productSize": null, "saleEndDate": "2024-06-04T22:00:00.000Z", "saleStartDate": "2024-04-30T22:00:00.000Z", 
"storeId": 3, "subCategoryId": "30", "userId": 1}, {"categoryId": "7", "favoritescol": null, "id": 308, "keywords": "alpsko,qumesht,pije",
 "productId": 6, "productName": "Alpsko this is long title that might", "productPic": "alpsko.png", "productSize": null,
  "saleEndDate": "2024-06-04T22:00:00.000Z", "saleStartDate": "2024-04-30T22:00:00.000Z", "storeId": 3, "subCategoryId": "70",
   "userId": 1}, {"categoryId": "2", "favoritescol": null, "id": 312, "keywords": null, "productId": 13, "productName": "Birra Heinekken",
    "productPic": "heineken.png", "productSize": null, "saleEndDate": "2024-08-14T22:00:00.000Z", 
    "saleStartDate": "2024-04-30T22:00:00.000Z", "storeId": 3, "subCategoryId": "20", "userId": 1}];


    //write code so if a product is in favorites array then add a new key to the product object called isFavorite and set it to true
    //if the product is not in the favorites array then add a new key to the product object called isFavorite and set it to false   
    //return the new array of products with the new key added to each product object

    function addIsFavoriteKey(allProducts, favorites) {
        //write code here
        let newProducts = allProducts.map(product => {
            let isFavorite = favorites.some(favorite => favorite.productId === product.productId);
            return {...product, isFavorite};
        });
        return newProducts;
    }


//write a function that takes an array of allproducts and if the current date is between the saleStartDate and saleEndDate of a product then add a new key to the product object called isOnSale and set it to true
//if the current date is not between the saleStartDate and saleEndDate of a product then add a new key to the product object called isOnSale and set it to false
//return the new array of products with the new key added to each product object
function addIsOnSaleKey(allProducts) {
    //write code here
    let newProducts = allProducts.map(product => {
        let isOnSale = new Date() >= new Date(product.saleStartDate) && new Date() <= new Date(product.saleEndDate);
        return {...product, isOnSale};
    });
    return newProducts;
}

//give the two functions from above combine them into one function 
//return the new array of products with the new key added to each product object
function addIsFavoriteAndIsOnSaleKey(allProducts, favorites) {
    //write code here
    let newProducts = allProducts.map(product => {
        let isFavorite = favorites.some(favorite => favorite.productId === product.productId);
        let isOnSale = new Date() >= new Date(product.saleStartDate) && new Date() <= new Date(product.saleEndDate);
        return {...product, isFavorite, isOnSale};
        //explain this line  return {...product, isFavorite, isOnSale};
        // The spread operator is used to copy the properties of the product object to a new object.
        // The isFavorite and isOnSale properties are added to the new object.
        //  The values of the isFavorite and isOnSale properties are the values of the isFavorite and isOnSale variables.
        //  The new object is returned.
    
    });
    return newProducts;
}

let allFilters = {

    subCategoryId: 0,
    categoryId: 0,
    storeId: 0,
    isFavorite: false,
    onSale: false,
  } ;

  //write a function that takes an object of filters allFilters and an array of products allproducts and returns a new array of products that match any the filters
  //if a filter is set to 0 or false then that filter is not applied
    //if a filter is set to a value other than 0 or false then that filter is applied
    //return the new array of products that match the filters

    function applyFilters(allFilters, allProducts) {
        //write code here
        let filteredProducts = allProducts.filter(product => {
            return (allFilters.subCategoryId === 0 || product.subCategoryId === allFilters.subCategoryId) &&
                (allFilters.categoryId === 0 || product.categoryId === allFilters.categoryId) &&
                (allFilters.storeId === 0 || product.storeId === allFilters.storeId) &&
                (!allFilters.isFavorite || product.isFavorite) &&
                (!allFilters.onSale || product.isOnSale);
        });
        return filteredProducts;
    }


//give array allProducts filter it where isOnSale is true given the isOnsale is a boolean value
//return the new array of products that are on sale
function getProductsOnSale(allProducts) {
    //write code here
    return allProducts.filter(product => product.isOnSale);
}


const useStore = create((set) => ({
    count: 0,
    myUserName: '',
    url : 'http://10.12.13.197:8800',
    admin: 1,
    subCategoryId: 0,
    categoryId: 0,
    storeId: 0,
    isFavorite: false,
    onSale: false,
    setMyUserName: (userData) => set((state) => ({ myUserName: userData })),
    increment: () => set((state) => ({ count: state.count + 1 })),
    decrement: () => set((state) => ({ count: state.count - 1 })),
    setSubCategoryId: (subCategoryId) => set(() => ({ subCategoryId: subCategoryId })),
    setCategoryId: (categoryId) => set(() => ({ categoryId: categoryId })),
    setStoreId: (storeId) => set(() => ({ storeId: storeId })),
    setIsFavorite: (isFavorite) => set(() => ({ isFavorite: isFavorite })),
    setOnSale: (onSale) => set(() => ({ onSale: onSale })),
  
  }));

// give the useStore object above with variables with default   subCategoryId: 0,
//    categoryId: 0,
//    storeId: 0,
//    isFavorite: false,
//    onSale: false,
// write function that when these variables are changed the allproducts array is filtered based on these variables
// filters are not applied if default values are used
// return a new array of matched objects based on the filters from allProducts

function applyStoreFilters(allProducts, useStore) {
    //write code here
    let filteredProducts = allProducts.filter(product => {
        return (useStore.subCategoryId === 0 || product.subCategoryId === useStore.subCategoryId) &&
            (useStore.categoryId === 0 || product.categoryId === useStore.categoryId) &&
            (useStore.storeId === 0 || product.storeId === useStore.storeId) &&
            (!useStore.isFavorite || product.isFavorite) &&
            (!useStore.onSale || product.isOnSale);
    });
    return filteredProducts;
}





